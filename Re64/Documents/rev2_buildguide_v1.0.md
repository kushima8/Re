# Re64_Rev2.0 ビルドガイド
![Re64_rev2](https://user-images.githubusercontent.com/58157342/132391649-6d02016a-f64a-4aa8-87b5-53f4af5d3301.jpg)
## はじめに
このたびはご購入いただきありがとうございます。<br>
本製品は組み立てが必要なキットです。<br>

Re64_Rev2は親指で操作可能なロータリーエンコーダーを備え、プログラマーなどに人気の高いあの配列を踏襲した60％分割キーボードです。<br>
使用するキーキャップについては[キーレイアウト](http://www.keyboard-layout-editor.com/##@@=Esc&=!%0A1&=%2F@%0A2&=%23%0A3&=$%0A4&=%25%0A5&=%5E%0A6&_x:3.75%3B&=%2F&%0A7&=*%0A8&=(%0A9&=)%0A0&=%2F_%0A-&=+%0A%2F=&=%7C%0A%5C&=~%0A%60%3B&@_w:1.5%3B&=Tab&=Q&=W&=E&=R&=T&_x:3.75%3B&=Y&=U&=I&=O&=P&=%7B%0A%5B&=%7D%0A%5D&_w:1.5%3B&=Backspace%3B&@_w:1.75%3B&=Ctrl&=A&=S&=D&=F&=G&_x:3.75%3B&=H&=J&=K&=L&=%2F:%0A%2F%3B&=%22%0A'&_w:2.25%3B&=Enter%3B&@_w:2.25%3B&=Shift&=Z&=X&=C&=V&=B&_x:3.75%3B&=N&=M&=%3C%0A,&=%3E%0A.&=%3F%0A%2F%2F&_w:1.75%3B&=Shift&=Fn%3B&@_w:1.5%3B&=Ctrl&=Fn&_w:1.5%3B&=GUI&_x:0.75&w:1.25%3B&=Space&_w:1.25%3B&=Space&_x:3&w:1.25%3B&=Space&_w:1.5%3B&=Space&_x:0.75&w:1.5%3B&=GUI&=ALT%3B&@_y:-0.75&x:7.25%3B&=SECOND&_x:1%3B&=SECOND)を確認してください。<br>
※中央付近に突き出した1Uはロータリーエンコーダーのブッシュスイッチを表しています。<br>

写真は作成見本であり商品内容と同一ではありません。<br>
また仕様は予告なく変更されることがあります。<br>

ファームウェアに[qmk_firmware](https://github.com/qmk/qmk_firmware)を採用しています。<br>
QMKにRe64_Rev2のコードはまだマージされていませんのでこの[ブランチ](https://github.com/kushima8/qmk_firmware/tree/re)を使用してください。<br>
動作確認の為にdefaultの[HEXファイル](https://github.com/kushima8/Re/blob/master/Re64/HEX)を用意しています。<br>
defaultを使用した場合、左側のPro MicroとPCを接続する設定となっております。<br>
右側で接続した場合はキーマップが反転します。<br>
反転せずに右側接続を行いたい場合は、右側最上段右端のキーを押下しながら接続することで対応可能です。<br>

キット作成前にPro Microの書き込み環境の構築を行ってください。<br>
ファームウェアの書き込み環境の構築については下記のサリチル酸さんのサイトを参考にしてください。<br>
[（初心者編）自作キーボードにファームウェアを書き込む](https://salicylic-acid3.hatenablog.com/entry/qmk-toolbox)<br>

キー割り当ての変更方法などはご自身でお調べいただくようお願いします。<br>

GUIから簡単にキー割り当てを変更できる[VIA](https://caniusevia.com/)と[Remap](https://remap-keys.app/)に対応しております。<br>
ロータリーエンコーダの回転割り当ても含め、設定できますのでご活用ください。<br>
VIAとRemapについては下記のサリチル酸さんのサイトを参考にしてください。<br>
[（初心者編）VIAを使ってキーマップを書き換えよう](https://salicylic-acid3.hatenablog.com/entry/via-manual)<br>
[（初心者編）Remapを使ってキーマップを書き換えよう](https://salicylic-acid3.hatenablog.com/entry/remap-manual)<br>
OLEDを接続していない場合は[re64_via.hex](https://github.com/kushima8/Re/blob/master/Re64/VIA/re64_via.hex)を、<br>
接続している場合は[re64_via_oled.hex](https://github.com/kushima8/Re/blob/master/Re64/VIA/re64_via_oled.hex)を使用してください。<br>
[re64_via.hex](https://github.com/kushima8/Re/blob/master/Re64/VIA/re64_via.hex)と[re64_via_oled.hex](https://github.com/kushima8/Re/blob/master/Re64/VIA/re64_via_oled.hex)ではロータリーエンコーダの初期割り当てが未設定ですので、動作確認時には[Remap](https://remap-keys.app/)などで割り当て設定をしてください。<br>

[プレートのデータ](https://github.com/kushima8/Re/tree/master/Re64/Plate)は公開中です。<br>
アルミプレートなど作成したい場合にお使いください。<br>

以下の部品リストを参考に欠品がないか確認をお願いします。<br>

## 部品

### キットに付属しているもの

|名称|数量|備考|
|----|:---:|----|
|PCB|2枚|右側用、左側用各1枚ずつ|
|トッププレート|2枚|右側用、左側用各1枚ずつ|
|ボトムプレート|2枚|右側用、左側用各1枚ずつ|
|保護プレート|4枚|内側用、外側用各2枚ずつ|
|M2 3mmスペーサー(ARB-2003E)|10個|丸型両メネジ|
|M2 6mmスペーサー(ARB-2006E)|12個|丸型両メネジ|
|M2 8mmスペーサー(ARB-2008E)|6個|丸型両メネジ|
|M2 4mmネジ|20本|
|M2 8mmネジ|10本|
|M2 12mmネジ|2本|
|ダイオード(1N4148/1N4148W)|66本/個|どちらかが同梱|
|Kailh PCB ソケット(MX用)|64個|
|タクトスイッチ|2個|
|TRRSジャック(MJ-4PP-9)|2個|
|プッシュスイッチ内蔵ロータリーエンコーダ(EC11E1834403)|2個|
|ゴム足|8個|
|DJ ミキサー用 つまみ  Chroma Caps Fatty Knob BLACK (180°)|1個|
|岩通アイセック ジョグダイヤルツマミ(黒)  R3310-6-SWA-11|1個|
|イモネジ|2個|ジョグダイヤル固定用|
|ステッカー|1枚|

### 別途、購入が必ず必要なもの
以下の部品は別途購入してください。

|名称|数量|備考|
|----|:---:|----|
|キースイッチ(Cherry MX互換)|64個|
|キーキャップ(Cherry MX互換)|64個|
|Pro Micro|2個|
|コンスルーピンヘッダ	|4個|
|TRRSケーブル|1本|
|2Uスタビライザー(Cherry MX互換)|2個|

### オプション
以下の部品はオプション品です。
キーボードを光らせたいなどの場合のみ別途購入してください。

|名称|数量|備考|
|----|:---:|----|
|LEDチップ(YS-SK6812MINI-E)|76個|
|OLEDモジュール|2個|
|OLED用ピンソケット|2個|

## 組み立て
* Re64(Rev1)になりますが、Daihukuさんによるビルドログ動画があります。<br>
 作成手順が似ており、本機を作成するにあたって参考になると思いますので是非御覧ください。<br>
 https://www.youtube.com/watch?v=lg03LpNXRAI
* 表面<br>
  ![001](https://user-images.githubusercontent.com/58157342/126727458-838ecdf3-6250-4c0e-a2c4-d83f5c967362.JPG)
* 裏面<br>
  ![002](https://user-images.githubusercontent.com/58157342/126727484-47587a77-cd97-4e4a-aaa1-891d003815bd.JPG)
* 1.ヤスリがけ
  * 製造の都合上PCBにバリが存在します。
  ![101](https://user-images.githubusercontent.com/58157342/126727620-a74e5f18-52b0-4416-b06b-97fe9c07ce10.jpg)
* 裏面<br>
  * この箇所を市販されている紙ヤスリなどで研磨してください。
* 2.Pro Microのはんだ付け
  * チップが載っている面が内側になるようにし、コンスルーピンヘッダを取り付けはんだ付けをしてください。
  * コンスルーピンヘッダには取り付け方向があるため気をつけてください。
  * [コンスルー - Self-Made Keyboards in Japan - ](https://scrapbox.io/self-made-kbds-ja/%E3%82%B3%E3%83%B3%E3%82%B9%E3%83%AB%E3%83%BC)<br>
  ![003](https://user-images.githubusercontent.com/58157342/89108152-21b31980-d471-11ea-9df6-11b106120852.JPG)
* 3.ファームウェアの書き込み
  * [re64_default.hex](https://github.com/kushima8/Re/blob/master/Re64/HEX/re64_default.hex)を指定してファームウェアを書き込んでください。
  * OLEDを使用する場合は'rules.mk'内の'OLED_DRIVER_ENABLE'を'yes'に書き換え、ご自身で環境を作っていただきファームウェアをコンパイルして頂くか、
  * もしくは[re64_via_oled.hex](https://github.com/kushima8/Re/blob/master/Re64/VIA/re64_via_oled.hex)を指定してファームウェアを書き込んでください。
  * [re64_via_oled.hex](https://github.com/kushima8/Re/blob/master/Re64/VIA/re64_via_oled.hex)ではロータリーエンコーダの初期割り当てが未設定ですので、動作確認時には[Remap](https://remap-keys.app/)などで割り当て設定をしてください。
* 4.LEDチップのはんだ付け(オプション)
  * LEDチップ((YS-SK6812MINI-E)はPCBを裏面にして右上から左下、反転したZ字を書くように実装してください。
  * その後表面にし左上から右下へZ字を書くように実装してください。
  * 高い温度ではんだ付けを行うとLED破損の可能性がありますので、約270℃に設定してはんだ付けをするようにしてください。
  * LEDは足が欠けている箇所が左下に来るように設置し、はんだ付けを行ってください。
  * はんだ付けが完了したら一度Pro Microを取り付け、LEDが光るかどうかテストを行ってください。<br>
  ![004](https://user-images.githubusercontent.com/58157342/89107187-23c5aa00-d46a-11ea-9957-75f56849463f.jpg)
* 5-1.ダイオードのはんだ付け(挿入実装の場合)
  * ダイオードの足を曲げ、PCB前面から取り付け、裏面からはんだ付けを行ってください。
  * ダイオードの向きは前面から見て左(三角形の頂点の先に縦棒がある方)に黒帯が来るように設置しはんだ付けを行ってください。
* 5-2.ダイオードのはんだ付け(表面実装の場合)
　* ダイオード取り付け箇所の片側に予めはんだを盛ります。
  * その後、表面に印刷がある方を表面にし、線が書いてある方を左(三角形の頂点の先に縦棒がある方)にセットします。
  * ダイオードをピンセットで持ちつつ、予めはんだを盛った箇所をはんだごてで加熱して片側だけはんだ付けを行います。
  * 片側のはんだ付けが完了後、もう片方もはんだ付けを行ってください。
* 6.Kailh PCB ソケット
  * 中央の穴に干渉しないようにソケットを設置してください。
  * ソケットの片側はんだ付けをしっかりと行い、基盤から浮いていないようであればもう片方もはんだ付けをしっかりと行ってください。
* 7.タクトスイッチ、TRRSジャックのはんだ付け
  * PCB表面から取り付け、裏面からはんだ付けを行ってください。
* 8.OLEDモジュール、OLED用ピンソケットのはんだ付け(オプション)
  * OLEDモジュールとピンヘッダのハンダ付けを行ってください。
  * ピンソケットをPCB表面から取り付け、裏面からはんだ付けを行ってください。
* 9.ロータリーエンコーダのはんだ付け
  * ロータリーエンコーダーの取り付け位置は内側と外側の選択式となっております。
  * どちらを選択しても同じ動作をするように設計しています。
  ![005](https://user-images.githubusercontent.com/58157342/89124922-99d31b00-d515-11ea-992a-3565d5d9ceed.JPG)
  * 使用するつまみ、または自身の手の大きさなどを考慮し自身で内側か外側かの選択を行ってください。
  * 取り付け位置選択後、PCB表面からロータリーエンコーダを取り付け、裏面からはんだ付けを行ってください。
* 10.スタビライザーの取り付け
  * 基盤にスタビライザーを取り付けてください。
* 11.トッププレートの取り付け
  * トッププレートの保護フィルムを剥がし、M2 3mmスペーサーをM2 8mmネジで固定してください。
  * その後、PCB表面に取り付け、サンドするようにM2 6mmスペーサーを裏面から取り付けてください。
* 12.保護プレート用スペーサーの取り付け
  * Pro Micro取り付け位置直下に位置する2箇所の穴に裏面からM2 4mmネジを入れ、M2 8mmスペーサーで固定してください。
* 13.ボトムプレートの取り付け
  * ボトムプレートの保護フィルムを剥がし、基板上でロータリーエンコーダの上部に位置する穴に対して裏面からM2 12mmネジを入れ、M2 6mmスペーサーで固定してください。
  * その後、M2 4mmネジを仕様し残りの箇所を固定してください。
* 14.キースイッチの取り付け
  * 基盤にキースイッチを取り付けてください。
* 15.Pro Microの取り付け
  * Pro Microを取り付け、PCと接続し、キースイッチとロータリーエンコーダの入力の確認を行ってください。
* 16.OLEDモジュールの取り付け(オプション)
  * OLEDモジュールを取り付け、PCと接続し、表示されることの確認を行ってください。
  * デフォルトでは左側にはレイヤーとLEDの光度情報、右側は真っ白な長方形が表示されます。
* 17.保護プレートの取り付け
  * ロータリーエンコーダーを内側に取り付けた場合は外側用の、内側に取り付けた場合は外側用の保護プレートを使用します。
  * ロータリーエンコーダー上部に位置する箇所から飛び出ているネジにM2 8mmスペーサーを固定。
  * そして、保護フィルムを剥がし、表面からM2 4mmねじで保護プレートを固定してください。
* 18.つまみの取り付け
  * つまみをロータリーエンコーダーに取り付けてください。
* 19.キーキャップの取り付け
  * キースイッチにキーキャップを取り付けてください。
  * 使用するキーキャップについては[キーレイアウト](http://www.keyboard-layout-editor.com/##@@=Esc&=!%0A1&=%2F@%0A2&=%23%0A3&=$%0A4&=%25%0A5&=%5E%0A6&_x:3.75%3B&=%2F&%0A7&=*%0A8&=(%0A9&=)%0A0&=%2F_%0A-&=+%0A%2F=&=%7C%0A%5C&=~%0A%60%3B&@_w:1.5%3B&=Tab&=Q&=W&=E&=R&=T&_x:3.75%3B&=Y&=U&=I&=O&=P&=%7B%0A%5B&=%7D%0A%5D&_w:1.5%3B&=Backspace%3B&@_w:1.75%3B&=Ctrl&=A&=S&=D&=F&=G&_x:3.75%3B&=H&=J&=K&=L&=%2F:%0A%2F%3B&=%22%0A'&_w:2.25%3B&=Enter%3B&@_w:2.25%3B&=Shift&=Z&=X&=C&=V&=B&_x:3.75%3B&=N&=M&=%3C%0A,&=%3E%0A.&=%3F%0A%2F%2F&_w:1.75%3B&=Shift&=Fn%3B&@_w:1.5%3B&=Ctrl&=Fn&_w:1.5%3B&=GUI&_x:0.75&w:1.25%3B&=Space&_w:1.25%3B&=Space&_x:3&w:1.25%3B&=Space&_w:1.5%3B&=Space&_x:0.75&w:1.5%3B&=GUI&=ALT%3B&@_y:-0.75&x:7.25%3B&=SECOND&_x:1%3B&=SECOND)を確認してください。
* 20.ゴム足の取り付け
  * ボトムプレートにゴム足を取り付けください。

組み立ての手順は、以上です。
